FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"IyB2aW06IHNldCBmaWxldHlwZT15YW1sIHNoaWZ0d2lkdGg9MiB0YWJzdG9wPTIgZXhwYW5kdGFi\
IHNtYXJ0aW5kZW50IDoKLS0tCnZlcnNpb246IDEuMApuYW1lOiB1bmlmaS1jb250cm9sbGVyLWFw\
YgpkZXNjcmlwdGlvbjogVWJpcXVpdGkgVW5pRmkgQ29udHJvbGxlcgpiaW5kYWJsZTogRmFsc2UK\
YXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBVQk5UIFVuaUZpIENvbnRy\
b2xsZXIgKEFQQikKICBkZXBlbmRlbmNpZXM6CiAgICAtICdkb2NrZXIuaW8vamFjb2JhbGJlcnR5\
L3VuaWZpJwpwbGFuczoKICAtIG5hbWU6IEVwaGVtZXJhbAogICAgZGVzY3JpcHRpb246IERlcGxv\
eSBVbmlGaSBjb250cm9sbGVyIHdpdGggZXBoZW1lcmFsIHN0b3JhZ2UgKHRlc3RpbmcpCiAgICBm\
cmVlOiBUcnVlCiAgICBkZWZhdWx0OiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5h\
bWU6IEVwaGVtZXJhbAogICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBleHRlcm5hbF9pcAog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBFeHRlcm5hbCBJUCBvZiBpbmZyYXN0\
cnVjdHVyZSBub2RlIChyZWdpb249aW5mcmEsIHZpcnR1YWwgSVApCiAgICAgICAgcmVxdWlyZWQ6\
IHRydWUKICAtIG5hbWU6IFBlcnNpc3RlbnQKICAgIGRlc2NyaXB0aW9uOiBEZXBsb3kgVW5pRmkg\
Y29udHJvbGxlciB3aXRoIHBlcnNpc3RlbnQgc3RvcmFnZQogICAgZnJlZTogVHJ1ZQogICAgbWV0\
YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBQZXJzaXN0ZW50CiAgICBwYXJhbWV0ZXJzOgogICAg\
ICAtIG5hbWU6IGV4dGVybmFsX2lwCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6\
IEV4dGVybmFsIElQIG9mIGluZnJhc3RydWN0dXJlIG5vZGUgKHJlZ2lvbj1pbmZyYSwgdmlydHVh\
bCBJUCkKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IHVuaWZpX2NvbnRyb2xs\
ZXJfdm9sdW1lX3NpemUKICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgZGVmYXVsdDogJzFHaScK\
ICAgICAgICBlbnVtOiBbJzFHaScsICc1R2knLCAnMTBHaSddCiAgICAgICAgdGl0bGU6IFVuaUZp\
IENvbnRyb2xsZXIgVm9sdW1lIFNpemUKICAgICAgICByZXF1aXJlZDogdHJ1ZQo="

COPY playbooks/* /opt/apb/project/
COPY . /opt/ansible/roles/unifi-controller-apb
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
